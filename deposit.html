<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Deposit â€” TrustMe AI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="style.css" rel="stylesheet">
  <style>
    body{background:#0a0f1a;color:#e6f1ff;font-family:sans-serif}
    .container{max-width:600px;margin:40px auto;padding:0 16px;text-align:center}
    .card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:18px;padding:20px}
    .btn{padding:.6rem .9rem;border-radius:12px;border:1px solid rgba(255,255,255,.2);
      background:#1a2b22;color:#d7ffe6;cursor:pointer}
    code{user-select:all}
    img.qr{width:200px;height:200px;margin:20px auto;display:block}
  </style>
</head>
<body>
<main class="container">
  <h1>Deposit (USDT-TRC20)</h1>
  <div class="card">
    <button id="btnGet" class="btn">Get Deposit Address</button>
    <div id="wrap" style="display:none">
      <img id="qr" class="qr" alt="QR">
      <p>Address:</p>
      <code id="addr"></code>
    </div>
    <div style="margin-top:20px">
      <input id="amt" type="number" min="10" placeholder="Amount" />
      <button id="btnTop" class="btn">Demo Top-up</button>
    </div>
    <p id="msg"></p>
  </div>
</main>

<script>
const API="http://localhost:8080";
async function getAddr(){
  const r=await fetch(API+"/wallet/deposit-address",{credentials:'include'}).then(r=>r.json());
  document.getElementById('addr').textContent=r.address;
  document.getElementById('qr').src=r.qr;
  document.getElementById('wrap').style.display="block";
}
async function topup(){
  const amt=Number(document.getElementById('amt').value||0);
  if(amt<=0)return alert("Enter valid amount");
  const r=await fetch(API+"/wallet/mock-credit",{method:"POST",credentials:'include',
    headers:{'Content-Type':'application/json'},body:JSON.stringify({amount:amt})}).then(r=>r.json());
  document.getElementById('msg').textContent="Balance updated. New available: "+r.balance_available;
}
document.getElementById('btnGet').onclick=getAddr;
document.getElementById('btnTop').onclick=topup;
</script>
</body>
</html>
